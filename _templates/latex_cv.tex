%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% A clean template for an academic CV
%
% Uses tabularx to create two column entries (date and job/edu/citation).
% Defines commands to make adding entries simpler.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[10pt, a4paper]{article}

% Full Unicode support for non-ASCII characters
\usepackage[utf8]{inputenc}
% Disable hyphenation
\usepackage[none]{hyphenat}
% Control the font size
\usepackage{anyfontsize}
% Icon fonts (requires using xelatex or luatex)
\usepackage[fixed]{fontawesome5}
\usepackage{academicons}
% For fancy and multipage tables
\usepackage{tabularx}
\usepackage{ltablex}

% Define a new environment to place all CV entries in a 2-column table.
% Template variables for styling
\newcommand{\TablePad}{\vspace{-0.4cm}}
\newcommand{\SoftwareTitle}[1]{{\bfseries #1}}
\newcommand{\TableTitle}[1]{{\fontsize{12pt}{0}\selectfont \itshape #1}}
% Left column are the dates, right column the entries.
\usepackage{environ}
\NewEnviron{EntriesTable}{
\TablePad
\begin{tabularx}{\textwidth}{@{}p{0.10\textwidth}@{\hspace{0.02\textwidth}}p{0.88\textwidth}@{}}
  \BODY
\end{tabularx}
}
\NewEnviron{EntriesTableExtra}{
\TablePad
\begin{tabularx}{\textwidth}{@{}p{0.10\textwidth}@{\hspace{0.02\textwidth}}p{0.79\textwidth}@{\hspace{0.02\textwidth}}>{\raggedright\arraybackslash}p{0.07\textwidth}}
  \BODY
\end{tabularx}
}

% Macros to add links and mark publications
\newcommand{\DOI}[1]{doi:\href{https://doi.org/#1}{#1}}
\newcommand{\DOILink}[1]{\href{https://doi.org/#1}{doi.org/#1}}
\newcommand{\Website}[1]{\href{https://#1}{#1}}
\newcommand{\Preprint}[1]{\href{https://doi.org/#1}{\faFilePdf}}
\newcommand{\Youtube}[1]{\href{https://www.youtube.com/watch?v=#1}{\faYoutube}}
\newcommand{\GitHub}[1]{\href{https://github.com/#1}{\faGithub}}
\newcommand{\Data}[1]{\href{https://doi.org/#1}{\faChartLine}}
\newcommand{\Slides}[1]{\href{https://#1}{\faTv}}
\newcommand{\SlidesDOI}[1]{\href{https://doi.org/#1}{\faTv}}
\newcommand{\PosterDOI}[1]{\href{https://doi.org/#1}{\faImage}}
\newcommand{\OA}{\thinspace\aiOpenAccess\enspace}

% Macros to set the year and duration on the left column
\newcommand{\Duration}[2]{\fontsize{9pt}{0}\selectfont #1 -- #2}
\newcommand{\Year}[1]{\fontsize{9pt}{0}\selectfont #1}
\newcommand{\Ongoing}{on}
\newcommand{\Future}{future}
\newcommand{\Appointment}[4]{\textbf{#1} \newline #2 \newline #3 \newline #4}

% Define command to insert month name and year as date
\usepackage{datetime}
\newdateformat{monthyear}{\monthname[\THEMONTH], \THEYEAR}

% Set the page margins
\usepackage[a4paper,margin=1.5cm,includehead,headsep=5mm]{geometry}

% To get the total page numbers (\pageref{LastPage})
\usepackage{lastpage}

% No indentation
\setlength\parindent{0cm}

% Increase the line spacing
\renewcommand{\baselinestretch}{1.2}
% and the spacing between rows in tables
\renewcommand{\arraystretch}{1.5}

% Remove space between items in itemize and enumerate
\usepackage{enumitem}
\setlist{nosep}

% Use custom colors
\usepackage[usenames,dvipsnames]{xcolor}

% Set fonts (requires compilation with xelatex)
\usepackage{fontspec}
%\setmainfont[%
  %Path = fonts/notoserif/,
  %UprightFont = NotoSerif-Regular,
  %BoldFont = NotoSerif-Bold,
  %ItalicFont = NotoSerif-Italic,
  %Extension = .ttf
%]{NotoSerif}



% Set the spacing for sections
\usepackage{titlesec}
\titleformat{\section}
  {\normalfont\Large\mdseries} % format
  {} % label
  {0pt} % separation (left separation for hang)
  {} % text before title
  [\titlerule] % text after title
\titleformat{\subsection}
  {\normalfont\large\mdseries} % format
  {} % label
  {0pt} % separation (left separation for hang)
  {} % text before title

% Disable number of sections. Use this instead of "section*" so that the sections still
% appear as PDF bookmarks. Otherwise, would have to add the table of contents entries
% manually.
\makeatletter
\renewcommand{\@seccntformat}[1]{}
\makeatother

% Set fancy headers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\lhead{\fontsize{9pt}{10pt}\selectfont
  \monthyear\today
}
\chead{
  \fontsize{9pt}{10pt}\selectfont
  [- config.author -]
  \hspace{0.2cm} -- \hspace{0.2cm}
  Curriculum Vit\ae
}
\rhead{\fontsize{9pt}{10pt}\selectfont \thepage{} of \pageref*{LastPage}}
\renewcommand{\headrulewidth}{0pt}

% Metadata for the PDF output and control of hyperlinks
\usepackage[colorlinks=true]{hyperref}
\hypersetup{
  pdftitle={ [- config.author -] - Curriculum Vit\ae},
  %pdfauthor={\MyName},
  linkcolor=blue,
  citecolor=blue,
  filecolor=black,
  urlcolor=MidnightBlue
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

% No header for the first page
\thispagestyle{empty}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Professional Appointments}

\begin{EntriesTable}
  [# for job in config.appointments #]
    \Duration{ [- job.start -] }{ [- job.end -] }  &
    \Appointment{[- job.title -]}{[- job.department -]}{[- job.school -]}{[- job.employer -], [- job.country -]}
  \\
  [# endfor #]
\end{EntriesTable}

\end{document}
